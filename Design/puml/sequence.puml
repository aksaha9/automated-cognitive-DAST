@startuml
!theme plain
actor User
participant "Frontend" as UI
participant "Backend" as API
participant "Gemini AI" as LLM
participant "ZAP Engine" as ZAP

== Planning ==
User -> UI: Enter "Scan Prompt"
UI -> API: POST /api/analyze {prompt}
API -> LLM: Generative Analysis
LLM --> API: {scan_type, checks, reasoning}
API --> UI: Scan Configuration

== Execution ==
User -> UI: Start Scan
UI -> API: POST /api/scan
API -> ZAP: Start Spider & Active Scan
activate ZAP

loop Polling (Every 5s)
    UI -> API: GET /api/scan/{id}
    API -> ZAP: Get Status
    ZAP --> API: Progress %
    API --> UI: Status Update
end

ZAP --> API: Scan Completed
deactivate ZAP

== Reporting ==
UI -> API: GET /api/scan/{id}/results
API -> API: Fetch Alerts
API --> UI: Vulnerability Report
@enduml
